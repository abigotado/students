# Реестр студентов

Консольное приложение для управления реестром студентов университета, реализованное с использованием архитектуры MVC (Model-View-Controller) на C++20.

## Описание

Приложение позволяет управлять информацией о студентах различных категорий:
- **Младшекурсники** - студенты 1-2 курса с оценками за сессию
- **Старшекурсники** - студенты 3-4 курса с оценками за сессию и исследовательской работой (УИР)
- **Выпускники** - студенты 5-6 курса с дипломным проектом

## Архитектура

Проект построен по принципу MVC:

### Model (Модель)
- `Student` - абстрактный базовый класс студента
- `JuniorStudent`, `SeniorStudent`, `GraduateStudent` - конкретные классы студентов
- `HashTable` - шаблонный контейнер для хранения данных с линейным пробированием

### View (Представление)
- `View` - класс для взаимодействия с пользователем через консоль

### Controller (Контроллер)
- `Controller` - класс, управляющий логикой приложения

## Функциональность

### Основные операции:
1. **Добавление студента** - создание нового студента с указанием категории и соответствующих данных
2. **Поиск студента** - поиск по ID
3. **Удаление студента** - удаление по ID
4. **Просмотр всех студентов** - отображение полного реестра

### Дополнительные возможности:
5. **Изменение группы** - перевод студента в другую группу
6. **Перевод студента** - изменение категории студента
7. **Просмотр оценок** - отображение всех оценок студента
8. **Средние оценки по группам** - статистика по группам (однопоточный и многопоточный режимы)
9. **Изменение исследовательской работы** - для старшекурсников

### Многопоточность
- **Параллельное вычисление средних оценок** - каждая группа обрабатывается в отдельном потоке
- **Синхронизация доступа** - использование мьютексов для thread-safe операций
- **Измерение производительности** - сравнение времени выполнения однопоточного и многопоточного режимов

## Сборка и запуск

### Требования:
- CMake 3.20+
- C++20 совместимый компилятор
- GoogleTest (для тестов)

### Сборка:
```bash
mkdir build
cd build
cmake ..
make
```

### Запуск:
```bash
./src/student_app
```

### Запуск тестов:
```bash
./tests/run_tests
```

## Структура проекта

```
students/
├── CMakeLists.txt          # Основной CMake файл
├── libs/
│   ├── model/              # Модель данных
│   │   ├── include/        # Заголовочные файлы
│   │   └── src/           # Реализация
│   ├── view/              # Представление
│   │   ├── include/
│   │   └── src/
│   └── controller/        # Контроллер
│       ├── include/
│       └── src/
├── src/                   # Главный файл приложения
├── tests/                 # Модульные тесты
├── docs/                  # Документация
│   ├── benchmark_results.csv      # CSV с результатами бенчмарка
│   ├── benchmark_results.png      # Основной график сравнения режимов
│   ├── benchmark_results_large_data.png # График для больших объёмов данных
│   ├── benchmark_report.md        # Markdown-отчёт по бенчмарку
│   ├── StudentRegistry.png        # UML-диаграмма классов (PNG)
│   └── UML_Diagram.puml           # PlantUML-диаграмма классов
└── README.md              # Документация проекта
```

## Особенности реализации

### HashTable
- Шаблонный контейнер с линейным пробированием
- Автоматическое изменение размера при превышении коэффициента загрузки
- Поддержка прямых итераторов
- Эффективный поиск, вставка и удаление O(1) в среднем случае

### Иерархия классов студентов
- Полиморфная архитектура с виртуальными методами
- Различные типы данных для каждой категории студентов
- Безопасное приведение типов с использованием dynamic_cast

### Многопоточность
- Использование std::async для параллельных вычислений
- std::mutex для синхронизации доступа к общим данным
- Измерение времени выполнения с помощью std::chrono
- Отсутствие race conditions благодаря правильной синхронизации

### Обработка ошибок
- Валидация входных данных
- Проверка существования студентов
- Информативные сообщения об ошибках
- Использование исключений вместо кодов возврата

### Современный C++20
- Использование умных указателей (unique_ptr)
- Алгоритмы STL (std::accumulate, std::copy)
- Контейнеры STL (std::map, std::vector, std::set)
- Chrono для измерения времени
- Future/promise для асинхронных операций

## Тестирование

Проект включает комплексные модульные тесты, покрывающие:
- Функциональность HashTable
- Создание и манипуляции со студентами
- Корректность итераторов
- Обработку ошибок

### Покрытие тестами
- 10 тестов в 4 тестовых наборах
- Покрытие всех основных компонентов
- Тестирование граничных случаев

## UML Диаграмма

Подробная UML диаграмма классов находится в файле `docs/UML_Diagram.md` и включает:
- Описание всех классов и их методов
- Связи между классами
- Особенности реализации

**Визуальная UML диаграмма:** `docs/StudentRegistry.png` - PNG изображение диаграммы классов, сгенерированное из PlantUML файла `docs/UML_Diagram.puml`.

Диаграмма показывает:
- **Model**: Иерархию классов студентов, шаблонный контейнер HashTable с итераторами
- **View**: Класс для взаимодействия с пользователем
- **Controller**: Класс управления логикой приложения
- **Связи**: Наследование, композиция, ассоциации между классами
- **Многопоточность**: Отметки о параллельных вычислениях

## Производительность

### Сравнение режимов вычисления средних оценок:
- **Однопоточный режим**: Последовательная обработка всех групп
- **Многопоточный режим**: Параллельная обработка каждой группы в отдельном потоке

Время выполнения измеряется и отображается для сравнения эффективности.

## Бенчмарк производительности

Проект включает комплексный бенчмарк для анализа производительности многопоточных вычислений.

### Возможности бенчмарка:
- **Генерация тестовых данных** — создание студентов разных категорий с случайными данными
- **Измерение производительности** — точное измерение времени выполнения операций
- **Сравнение режимов** — однопоточный vs многопоточный для вычисления средних оценок
- **Анализ масштабируемости** — как производительность зависит от размера данных
- **Автоматическое построение графиков** — визуализация результатов
- **Автоматический отчёт** — Markdown-отчёт с таблицей и выводами

### Запуск бенчмарка:

#### Автоматический запуск (рекомендуется):
```bash
./scripts/run_benchmark.sh
```

#### Ручной запуск:
```bash
mkdir build && cd build
cmake .. && make
./src/benchmark
cd ..
python3 scripts/plot_benchmark.py
```

### Результаты бенчмарка и графики

После запуска бенчмарка и анализа в папке `docs/` появятся:
- `benchmark_results.csv` — таблица с результатами для разных объёмов данных
- `benchmark_results.png` — основной график (4 подграфика: время, ускорение, экономия времени, эффективность)
- `benchmark_results_large_data.png` — график для больших объёмов данных (наглядно видна разница >2x)
- `benchmark_report.md` — подробный отчёт с таблицей, статистикой и выводами

**Интерпретация графиков:**
- Для малых объёмов данных ускорение незначительно или отсутствует (overhead)
- Для больших объёмов (100 000+ студентов) многопоточный режим даёт ускорение более чем в 2 раза
- Эффективность параллелизма растёт с увеличением объёма данных

**Внимание:**
- Скрипт `scripts/performance_test.sh` больше не используется и удалён из проекта.
- Для анализа используйте только `src/benchmark.cpp` и `scripts/plot_benchmark.py`.

## Лицензия

Этот проект создан в образовательных целях.

## Анализ кода

Проект включает настройки для статического и динамического анализа кода:

### Статический анализ
- **Компиляторные предупреждения**: Включены все предупреждения (-Wall -Wextra -Wpedantic)
- **Clang Static Analyzer**: Автоматический анализ при компиляции
- **cppcheck**: Дополнительный статический анализ (опционально)

### Динамический анализ
- **Address Sanitizer**: Обнаружение утечек памяти и ошибок доступа
- **Thread Sanitizer**: Обнаружение race conditions в многопоточном коде

### Запуск анализа
```bash
# Полный анализ кода
./scripts/analysis.sh

# Или по отдельности:
mkdir build_analysis && cd build_analysis

# Статический анализ
cmake .. -DCMAKE_BUILD_TYPE=Debug
make

# Анализ утечек памяти
cmake .. -DCMAKE_BUILD_TYPE=Debug -DENABLE_ADDRESS_SANITIZER=ON
make
./tests/run_tests

# Анализ многопоточности
cmake .. -DCMAKE_BUILD_TYPE=Debug -DENABLE_THREAD_SANITIZER=ON
make
./tests/run_tests
```

### Результаты анализа
- Отсутствие утечек памяти подтверждено Address Sanitizer
- Отсутствие race conditions подтверждено Thread Sanitizer
- Код проходит все проверки статического анализатора
